!(1â‰¡â‰ ) â€¢args

Splitâ†(â‰¢âŸœâŸ¨âŸ©)Â¨âŠ¸/ ((1-Ëœ(1++`)âˆ§Â¬)âˆŠËœ)âŠ”âŠ¢
UnionFindâ†{
	ğ•Š init: {
		reprâ†â€¢HashMapËœ init
		Findâ‡{ ğ•©â‰¢repr.Get ğ•©? ğ•©âŠ¸repr.SetâŠ¸âŠ¢ ğ•Š repr.Get ğ•©; ğ•© }
		Unionâ‡repr.Setâ—‹Find
		Reprsâ‡repr.Values
	}
}

inputâ†(" :"âŠ¸Split)Â¨ â€¢FLines âŠ‘âŠ"sample" â€¢args
edgesâ†âˆ¾((<âŠ‘)â‹ˆÂ¨1âŠ¸â†“)Â¨ input
verticesâ†â·âˆ¾input

# Do the (unboosted) random contraction thing
{
	ğ•¤
	Unionâ€¿Findâ€¿Reprsâ†UnionFind vertices
	(â‰ vertices) {
		ğ•¨ ğ•Š 2: 2;
		uâ€¿v ğ•Š n:
			ruâ†Find u â‹„ rvâ†Find v
			{ ruâ‰¢rv? ru Union rv â‹„ n-1; ğ•¤â‹„n } @
	}Â´ (â€¢rand.Dealâ‰ )âŠ¸âŠ edges
	cutâ†â‰  (âŠ‘â‰¢1âŠ¸âŠ‘)Â¨âŠ¸/ FindÂ¨Â¨ edges
	{ cutâ‰¡3? ğ•¤ â‹„ â€¢Show  Ã—Â´â‰ Â¨âŠâŠ¸âŠ” Reprs@ â‹„ 0; 1 } @
} â€¢_while_ âŠ¢ 1
