!(1â‰¡â‰ ) â€¢args

Splitâ†(â‰¢âŸœâŸ¨âŸ©)Â¨âŠ¸/ ((1-Ëœ(1++`)âˆ§Â¬)âˆŠËœ)âŠ”âŠ¢
UnionFindâ†{
	ğ•Š init: {
		reprâ†â€¢HashMapËœ init
		Findâ‡{ğ•©â‰¢repr.Get ğ•©? ğ•©âŠ¸repr.SetâŠ¸âŠ¢ ğ•Š repr.Get ğ•©; ğ•©}
		Unionâ‡repr.Setâ—‹Find
		Reprsâ‡repr.Values
	}
}

inputâ†(" :"âŠ¸Split)Â¨ â€¢FLines (âŠ‘)âŠ"input" â€¢args
edgesâ†âˆ¾âˆ¾((<âŠ‘)(â‹ˆËœâ‹ˆâ‹ˆ)Â¨(1âŠ¸â†“))Â¨ input
graphâ†(âŠ‘âˆ˜âŠ‘Â¨ â€¢HashMap (âˆ¾1âŠ¸â†“Â¨)Â¨) (âŠâŠ‘Â¨)âŠ¸âŠ” edges

# Do the (unboosted) random contraction thing
nâ†graph.Count@
{
	ğ•¤
	Unionâ€¿Findâ€¿Reprsâ†UnionFind graph.Keys@
	(graph.Count@) {
		ğ•¨ ğ•Š 2: 2;
		uâ€¿v ğ•Š n:
			ruâ†Find u â‹„ rvâ†Find v
			{ ruâ‰¢rv? ru Union rv â‹„ n-1; ğ•¤â‹„n } @
	}Â´ (â€¢rand.Dealâ‰ )âŠ¸âŠ edges
	cutâ† 2Ã·Ëœâ‰  (âŠ¢â‰¢âŒ½)Â¨âŠ¸/ FindÂ¨Â¨ edges
	{ cutâ‰¡3? ğ•¤ â‹„ â€¢Show  Ã—Â´â‰ Â¨âŠâŠ¸âŠ” Reprs@ â‹„ 0; 1 } @
} â€¢_while_ âŠ¢ 1
